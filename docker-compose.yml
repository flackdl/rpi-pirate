version: '2'

services:
 transmission:
  image: flackdl/rpi-transmission-openvpn
  cap_add:
    - NET_ADMIN
  devices:
    - "/dev/net/tun"
  restart: always
  ports:
    - "9091:9091"
    - "8888:8888"
  dns:
    - 8.8.8.8
    - 8.8.4.4
  volumes:
    - /etc/localtime:/etc/localtime:ro
    - /media/pi/blackhole/torrents:/data
  env_file:
    - .env
  environment:
    - OPENVPN_OPTS=--inactive 3600 --ping 10 --ping-exit 60
    - LOCAL_NETWORK=192.168.1.0/24
 proxy:
  image: flackdl/rpi-transmission-openvpn-proxy
  restart: always
  links:
    - transmission
  ports:
    - "8080:8080"
  volumes:
    - /etc/localtime:/etc/localtime:ro

 sonarr:
  image: lsioarmhf/sonarr
  restart: always
  ports:
    - "8989:8989"
  volumes:
    - /media/pi/blackhole/torrents/completed/:/downloads
    - /media/pi/blackhole/torrents/completed/:/tv
    - /media/pi/blackhole/torrents/sonarr:/config 

 radarr:
  image: lsioarmhf/radarr
  restart: always
  ports:
    - "7878:7878"
  volumes:
    - /media/pi/blackhole/torrents/completed/:/downloads
    - /media/pi/blackhole/torrents/completed/:/movies
    - /media/pi/blackhole/torrents/radarr:/config 

 ombi:
  image: lsioarmhf/ombi
  restart: always
  ports:
    - "3579:3579"
  volumes:
    - /media/pi/blackhole/torrents/ombi:/config 

 jackett:
  image: lsioarmhf/jackett
  restart: always
  ports:
    - "9117:9117"
  volumes:
    - /media/pi/blackhole/torrents/completed:/downloads
    - /media/pi/blackhole/torrents/jackett:/config 

 samba:
  image: flackdl/samba-armhf
  restart: always
  ports:
    - "137:137/udp"
    - "138:138/udp"
    - "139:139"
    - "445:445"
  env_file:
    - .env
  command: -n -u "${SMB_USER};${SMB_PASS}" -s "torrents;/torrents" -g "min protocol = CORE" -g "netbios name = rpi" -g "workgroup = blackhole"
  volumes:
    - /etc/localtime:/etc/localtime:ro
    - /media/pi/blackhole/torrents/:/torrents:ro
